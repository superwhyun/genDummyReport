from docxtpl import DocxTemplate, InlineImage
import jinja2
from docx.shared import Mm



doc = DocxTemplate("./template/lab_safety_report_template.docx")

import calendar

week_list = ["MON", "TUE", "WED", "THU", "FRI", "SAT", "SUN"]

cals = []

for r in range(1, 27):
    cal = []
    for i in range(1, 32):    
        # print(week_list[calendar.weekday(2021, 4, i)])
        try:
            weekday = calendar.weekday(2021, 4, i)
            if(weekday == 5 or weekday == 6): cal.append('-')
            elif(weekday >= 0 and weekday < 5): cal.append('o')
        except:        
            # print('error: ', i)
            cal.append('-')
    cals.append(cal)

# import numpy as np
# print(np.matrix(cals))

payload = {
    'date': {
        'year': 2021,
        'mon' : 4
    },
    'lab': {
        'name': '우주정거장',
        'buildingNo': '은하철도',
        'roomNo' : '999',
        'safety_manager' : '실험실 관리자',
        'boss' : '실장'
    },
    'colcol': 'o',
    'myimage' : InlineImage(doc,'./resources/circle1.png',width=Mm(3)),
    'myimage2' : InlineImage(doc,'./resources/circle2.png',width=Mm(3)),
    'myimage3' : InlineImage(doc,'./resources/circle3.png',width=Mm(3)),
    'content': {
        'rows': [
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],
            ['-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','-','-','o','o','o','o','o','-','-','o','o','o','o',],

        ]
    }
}

payload['content']['rows'] = cals

doc.render(payload)
doc.save("./output/lab_safety_report.docx")